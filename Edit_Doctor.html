<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./ALL_CSS_FILE/style.css">

    <!-- font awsome librey link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- bootstrap css link -->
    <link rel="stylesheet" href="./bootstrap-5.0.2-dist/css/bootstrap.min.css">
    <!-- singal line chart link  -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script src="./ALL_JAVA_SCRIPT_FILE/script.js"></script>
    <script src="./ALL_JAVA_SCRIPT_FILE/coulmnchart.js"></script>
    <script src="jquery.min.js"></script>
    <script src="ALL_JAVA_SCRIPT_FILE/api.js"></script>

    <!-- singal line chart link finsh  -->

    <title>Document</title>
</head>

<body>
    <!-- nav bar code start  -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary  ">
        <div class="container-fluid align-items-center">
            <!-- nav bar logo image code strat  -->
            <a class="navbar-brand" href="#">Hopshee</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- nav bar logo image code complete -->
            <!-- nav bar page menu code start -->
            <div class="collapse navbar-collapse justify-content-between" id="collapsibleNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="index.html">Deshbord</a>
                    </li>
                    <!-- nev bar drop down menu text1 code start -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button"
                            data-bs-toggle="dropdown">Doctor</a>
                        <ul class="dropdown-menu bg-primary">
                            <li><a class="dropdown-item text-white" href="All_Doctor.html">All-Doctor</a></li>
                            <li><a class="dropdown-item text-white" href="Add_Doctor.html">Add-doctor</a></li>
                            <li><a class="dropdown-item text-white" href="Edit_Doctor.html">Edit-doctor</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button"
                            data-bs-toggle="dropdown">Patient</a>
                        <ul class="dropdown-menu bg-primary">
                            <li><a class="dropdown-item text-white" href="All_patient.html">All-Patient</a></li>
                    </li>
                </ul>
                </li>
                <!-- nev bar drop down menu text1 code finsh-->
                <!-- nev bar drop down menu text3 code start -->
                <!-- <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button"
                            data-bs-toggle="dropdown">Doctor
                            Sidual</a>
                        <ul class="dropdown-menu bg-primary">
                            <li><a class="dropdown-item text-white" href="#">Add-Docotr-Sidual</a></li>
                            <li><a class="dropdown-item text-white" href="#">Edit-Patient-Sidual</a></li>
                        </ul>
                    </li> -->
                <!-- nev bar drop down menu text3 code finsh -->
                </ul>
                <button style="background-color: transparent; border: transparent; color: white;"
                    id="Logout">Logout</button>
                <!-- nav bar page menu code finsh  -->
                <!-- nav bar code icon  -->
                <!-- <div class="d-flex col-md-2 justify-content-around align-items-center">
                    <a href="#" class="text-white  nav-icon iconClass"><i class="fa-regular fa-bell"
                            style="font-size: 20px;"></i></a>
                    <a href="#" class="text-white"><i class="fa-regular fa-envelope" style="font-size: 20px;"></i></a>

                    <div class="dropdown ">
                        <button class="dropdown-toggle btn btn-default" id="menu1" data-bs-toggle="dropdown">
                            <img src="./image/profile.png" alt="" height="30px" class="rounded-pill"></i>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu bg-primary" role="menu" aria-labelledby="menu1">
                            <li class="nav-link"><a class="dropdown-item text-white" href="#">PROFILE</a></li>
                            <li class="divider"></li>
                            <li class="nav-link"><a class="dropdown-item text-white" href="#">SETTING</a></li>
                        </ul>
                    </div>
                </div> -->
                <!-- nav bar icon code finsh  -->
            </div>
        </div>
    </nav>

    <body>
        <div class="first_part_body ">
            <div class="deshbord_normal">
                <h1> Deshbord </h1>
            </div>
            <div class="bg-white">
                <div class="bg-primary mt-4 text-white text-center p-5">
                    <h2>Edit Doctor Details</h2>
                    <p>please Enter proper and valid data. if you are not enter proper and valid data data then your enterd data is not enter.</p>
                </div>
                <div style="border: 1px solid rgb(212, 202, 202)" class="mt-5 container px-5">
                    <div class="p-3 mt-4">
                        <h4>Basic Information</h4>
                    </div>
                    <!-- <div class="m-2 mx-5">
                        <div class="my-3">
                            <label for="" class="my-1"> NAME : </label>
                            <br>
                            <input type="text" name="" id="" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DATE OF BIRTH : </label>
                            <br>
                            <input type="date" name="" id="" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> GENDER : </label>
                            <br>
                            <select type="" name="gender" id="" style="width: 100%; height: 40PX;">
                                <option value="MALE"> MALE </option>
                                <option value="FEMALE"> FEMALE </option>
                                <option value="OTHER"> OTHER </option>
                            </select>
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> PROFILE IMAGE : </label>
                            <br>
                            <input type="file" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>

                        <div class="my-3">
                            <label for="" class="my-1"> SPECIALITY : </label>
                            <br>
                            <input type="text" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> BRIF : </label>
                            <br>
                            <input type="text" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> WEBSITE URL : </label>
                            <br>
                            <input type="text" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div>
                            <input type="button" value="SAVE" class="bg-primary text-white py-1 px-3"
                                style="border: 0.1px rgb(190, 190, 190) solid;">
                            <input type="button" value="CANCAL" style="border: none;" class="px-3 py-1  ">
                        </div>
                    </div>
                        </div>
                    <div style="border: 1px solid rgb(212, 202, 202)" class="mt-5 container">
                    <div class="p-3 mx-4 mt-4">
                        <h4>Doctor Account Info</h4>
                    </div>
                    <div class="m-2 mx-5">
                        <div class="my-3">
                            <label for="" class="my-1"> E-MAIL : </label>
                            <br>
                            <input type="email" name="" id="" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> MO-PHONE : </label>
                            <br>
                            <input type="number" name="" id="" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> PASSWORD : </label>
                            <br>
                            <input type="password" name="" id="" autofocus="OF"
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> CONFORM PASSWORD : </label>
                            <br>
                            <input type="password" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div>
                            <input type="button" value="SAVE" class="bg-primary text-white py-1 px-3"
                                style="border: 0.1px rgb(190, 190, 190) solid;">
                            <input type="button" value="CANCAL" style="border: none;" class="px-3 py-1  ">
                        </div>
                    </div>
                    </div>
                 <div style="border: 1px solid rgb(212, 202, 202)" class="mt-5 container">
                    <div class="p-3 mx-4 mt-4">
                        <h4>Doctor Social Media Info</h4>
                    </div>
                    <div class="m-2 mx-5">
                        <div class="my-3">
                            <label for="" class="my-1"> FACE-BOOK URL : </label>
                            <br>
                            <input type="url" name="" id="" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> TWITTER URL : </label>
                            <br>
                            <input type="url" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> Google Plus URL : </label>
                            <br>
                            <input type="url" name="" id=""
                                style="width: 100%; height: 40PX; border: 1px  solid rgb(114, 114, 114); padding: 4px;">
                        </div>
                        <div>
                            <input type="button" value="SAVE" class="bg-primary text-white py-1 px-3"
                                style="border: 0.1px rgb(190, 190, 190) solid;">
                            <input type="button" value="CANCAL" style="border: none;" class="px-3 py-1  ">
                        </div>
                    </div>
                    </div> -->
                    <div>
                        <!-- <div class="my-3">
                            <label for="" class="my-1"> DR IMAGE : </label>
                            <br>
                            <input type="file" name="" id="dr_image"
                                style="padding-top: 3px; padding-left: 5px; width: 100%; height: 40PX; border: 1px solid #767676; border-radius: 2px;">
                        </div>
                        <h6 id="checkimg" style="color: rgb(204, 14, 14);">** image missing </h6> -->
                        <div class="my-3">
                            <label for="" class="my-1"> NAME : </label>
                            <br>
                            <input type="text" name="" id="dr_name" style="width: 100%; height: 40PX;">
                            <h6 id="checkname" style="color: rgb(204, 14, 14);">**name is missing</h6>
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> EMAIL ID : </label>
                            <br>
                            <input type="email" name="" id="email_id" style="width: 100%; height: 40PX;">
                            <h6 id="checkemail" style="color: rgb(204, 14, 14);">** Invalid Email</h6>

                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> PHONE NO : </label>
                            <br>
                            <input type="number" name="" id="phoen_no" style="width: 100%; height: 40PX;">
                            <h6 id="checknumber" style="color: rgb(204, 14, 14);">** enter 10 digits number</h6>

                        </div>
                        <!-- <div class="my-3">
                            <label for="" class="my-1"> PASSWORD : </label>
                            <br>
                            <input type="password" name="" id="password" style="width: 100%; height: 40PX;">
                            <h6 id="checkpassword" style="color: rgb(204, 14, 14);">** password missing</h6>
                        </div> -->
                        <div class="my-3">
                            <label for="" class="my-1"> GENDER( M / F ) : </label>
                            <br>
                            <input type="text" name="" id="gender" style="width: 100%; height: 40PX;">
                            <h6 id="checkgender" style="color: rgb(204, 14, 14);;"> Enter M or F</h6>
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DATE OF BIRTH : </label>
                            <br>
                            <input type="date" name="" id="date_of_birth" style="width: 100%; height: 40PX;">
                            <h6 id="checkdate" style="color: rgb(204, 14, 14);;"> Enter proper date </h6>
                        </div>
                        <!-- <div class="my-3">
                            <label for="" class="my-1"> PASSWORD : </label>
                            <br>
                            <input type="password" name="" id="password" style="width: 100%; height: 40PX;">
                            <h6 id="checkpassword" style="color: rgb(204, 14, 14);">** password missing</h6>
                        </div> -->
                        <div class="my-3">
                            <label for="" class="my-1"> SPECIALITY : </label>
                            <br>
                            <input type="text" name="" id="speciality" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DISCRIPTON : </label>
                            <br>
                            <input type="text" name="" id="discription" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DOCTOR CERTIFICAT NUMBER : </label>
                            <br>
                            <input type="text" name="" id="dr_certificte_number" style="width: 100%; height: 40PX;">
                        </div>
                        <h6 id="checkdrno" style="color: rgb(204, 14, 14);">** Enter image certificate number</h6>
                        <!-- <div class="my-3">
                            <label for="" class="my-1"> DR CERTIFICATE IMAGE : </label>
                            <br>
                            <input type="file" name="" id="dr_certi_image"
                                style="padding-top: 3px; padding-left: 5px; width: 100%; height: 40PX; border: 1px solid #767676; border-radius: 2px;">
                        </div> -->

                        <div class="my-3">
                            <label for="" class="my-1"> DR TIME FROM : </label>
                            <br>
                            <input type="time" name="" id="dr_time_from" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DR TIME TO : </label>
                            <br>
                            <input type="time" name="" id="dr_time_to" style="width: 100%; height: 40PX;">
                        </div>
                        <div class="my-3">
                            <label for="" class="my-1"> DR SALARY AMOUNT : </label>
                            <br>
                            <input type="number" name="" id="dr_salary" style="width: 100%; height: 40PX;">
                        </div>
                    </div>
                    <div width="100%">
                        <button style="width: 100%; height: 42px; margin-bottom: 18px; margin-top: 10px;"
                            id="btnsubmit"> SUBMIT
                        </button>
                    </div>
                </div>
            </div>

    </body>
    <!-- bootstrap java script link  -->
    <script src="./bootstrap-5.0.2-dist/js/bootstrap.bundle.js"></script>
    <!-- bootstrap java script link  complete -->
    <script>
        $(document).ready(function () {
            $("#Logout").click(function () {
                console.log("Logout");
                setCookie("admin_id", "", 1);
                setCookie('employee_id', "", 1);
                window.location.replace("login.html");
            });
            // Extract the doctorId from the URL
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const doctorId = urlParams.get("doctor_id");

            // Check if doctorId is valid
            if (doctorId) {
                // Make an API request to retrieve doctor details and populate the form fields
                $.ajax({

                    url: `${doctors}/${doctorId}`,// Replace with your API endpoint to fetch doctor details  
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                        const doctor = data.data[0];
                        $("#dr_name").val(doctor.doctor_name);
                        $("#email_id").val(doctor.email_id);
                        $("#phoen_no").val(doctor.phone_no);
                        // $("#password").val(doctor.password);
                        $("#gender").val(doctor.gender);
                        // $("#date_of_birth").val(doctor.date_of_birth);
                        // $("#dr_image").val(doctor.image_url);
                        $("#speciality").val(doctor.speciality);
                        $("#discription").val(doctor.brief_desc);
                        $("#dr_certificte_number").val(doctor.doctor_certi_no);
                        // $("#dr_certi_image").val(doctor.doctor_certi_image_url);
                        // $("#dr_time_from").val(doctor.doctor_time_from);
                        // $("#dr_time_to").val(doctor.doctor_time_to);
                        $("#dr_salary").val(doctor.salary_amount);
                    },
                    error: function (error) {
                        console.log("Error fetching doctor details: " + error);
                    }
                });

                $("#checkname").hide();
                $("#dr_name").keyup(function () {
                    validateuname();
                });
                function validateuname() {
                    let unamevalue = $("#dr_name").val();
                    if (unamevalue.length == "") {
                        $("#checkname").show();
                        return true;
                    }
                    else if (unamevalue.length < 3 || unamevalue.length > 20) {
                        $("#checkname").show();
                        $("#checkname").html("**enter username between 3 to 20");
                        return true;
                    }
                    else {
                        $("#checkname").hide();
                        return false;
                    }
                }
                $("#checkemail").hide();

                $("#email_id").keyup(function () {
                    validateemail();
                });
                function validateemail() {
                    let emailvalue = $("#email_id").val();
                    let regularexpression = /^([a-zA-Z\d\.\-]+)@([a-zA-Z\d\.\-]+)\.([a-zA-Z]{2,6})$/;
                    if (regularexpression.test(emailvalue)) {
                        $("#checkemail").hide();
                        return false;
                    }
                    else {
                        $("#checkemail").show();
                        $("#checkemail").html(" ** Enter @ and . format ")
                        return true;
                    }
                }
                // $("#checkpassword").hide();
                // $("#password").keyup(function () {
                //     validatepassword();
                // });
                // function validatepassword() {
                //     let passvalue = $("#password").val();
                //     if (passvalue.length == "") {
                //         $("#checkpassword").show();
                //         return true;
                //     }
                //     else if (passvalue.length < 8) {
                //         $("#checkpassword").show();
                //         $("#checkpassword").html("**enter password greter then 8 digits");
                //         return true;
                //     }
                //     else {
                //         $("#checkpassword").hide();
                //         return false;
                //     }
                // }
                $("#checknumber").hide();
                $("#phoen_no").keyup(function () {
                    validateno();
                });
                function validateno() {
                    let novalue = $("#phoen_no").val();
                    if (novalue.length == "") {
                        $("#checknumber").show();
                        return true;
                    }
                    else if (novalue.length != 10) {
                        $("#checknumber").show();
                        $("#nocheck").html("**enter 10 digit contact no");
                        return true;
                    }
                    else {
                        $("#checknumber").hide();
                        return false;
                    }
                }

                $("#checkgender").hide();
                $("#gender").keyup(function () {
                    validategender();
                });
                function validategender() {
                    let genvalue = $("#gender").val();
                    if (genvalue.length == "") {
                        $("#checkgender").show();
                        // $("#checkgender").html("**enter compolsory");
                        return true;
                    }
                    if (genvalue == "M" || genvalue == "F") {
                        $("#checkgender").hide();
                        return false;

                    } else {
                        $("#checkgender").show();
                        return true;
                    }
                }

                $("#checkdate").hide();
                $("#date_of_birth").on("input", function () {
                    validateDate();
                });

                function validateDate() {
                    let dateValue = $("#date_of_birth").val();
                    let selectedDate = new Date(dateValue);
                    let currentDate = new Date();
                    currentDate.setFullYear(currentDate.getFullYear() - 23); // Subtract 23 years from the current date

                    if (selectedDate <= currentDate) {
                        $("#checkdate").hide();
                        return false;
                    } else {
                        $("#checkdate").show();
                        return true;
                    }
                }

                $("#checkimg").hide();
                $("#dr_image").on("input", function () {
                    validateimg();
                });

                // function validateimg() {
                //     var fileInput = this;
                //     var validationMessage = $("#checkimg");

                //     if (fileInput.files.length > 0) {
                //         var file = fileInput.files[0];
                //         var fileType = file.type.toLowerCase();

                //         if (fileType === "image/jpeg" || fileType === "image/png" || fileType === "image/gif") {
                //             validationMessage.hide();
                //             return false;

                //         } else {
                //             validationMessage.show("Please select a valid image file (JPEG, PNG, GIF).");
                //             return true;
                //         }
                //     } else {
                //         // If no file was selected, clear the validation message
                //         validationMessage.show("plese file select");
                //         return true;
                //     }
                // }

                // function validateimg() {
                //     var fileInput = document.getElementById("dr_image");
                //     var validationMessage = $("#checkimg");

                //     if (fileInput.files.length > 0) {
                //         var file = fileInput.files[0];
                //         var fileType = file.type.toLowerCase();

                //         if (fileType === "image/jpeg" || fileType === "image/png" || fileType === "image/gif") {
                //             validationMessage.hide(); // Hide the validation message
                //             return false;
                //         } else {
                //             validationMessage.show(); // Show the validation message
                //             validationMessage.html("Please select a valid image file (JPEG, PNG, GIF).");
                //             return true;
                //         }
                //     } else {
                //         // If no file was selected, clear the validation message
                //         validationMessage.show(); // Hide the validation message
                //         return true;
                //     }
                // }

                $("#checkdrno").hide();
                $("#dr_certificte_number").keyup(function () {
                    validatedrno();
                });
                function validatedrno() {
                    let genvalue = $("#dr_certificte_number").val();
                    if (genvalue.length == "") {
                        $("#checkdrno").show();
                        // $("#checkgender").html("**enter compolsory");
                        return true;
                    }
                    else {
                        $("#checkdrno").hide();
                        return false;
                    }
                }
                // Handle the update button click
                $("#btnsubmit").click(function () {
                    console.log(validateno(), validateuname(), validategender(), validateDate(), validatedrno());
                    if (validateno() == true || validateuname() == true || validateemail() == true || validategender() == true || validateDate() == true || validatedrno() == true) {
                        return alert("Enter Proper data");
                    }
                    else {
                        // Gather updated data from the input fields
                        const updatedData = {
                            doctor_id: doctorId,
                            doctor_name: $("#dr_name").val(),
                            email_id: $("#email_id").val(),
                            phone_no: $("#phoen_no").val(),
                            gender: $("#gender").val(),
                            date_of_birth: $("#date_of_birth").val(),
                            speciality: $("#speciality").val(),
                            brief_desc: $("#discription").val(),
                            doctor_certi_no: $("#dr_certificte_number").val(),
                            doctor_time_from: $("#dr_time_from").val(),
                            doctor_time_to: $("#dr_time_to").val(),
                            salary_amount: $("#dr_salary").val(),
                        };
                        // Make an API request to update the doctor's details using PATCH
                        $.ajax({
                            url: `${doctors}`, // Replace with your API endpoint for updating doctor details
                            type: "PATCH", // Use PATCH method
                            data: JSON.stringify(updatedData),
                            contentType: "application/json",
                            success: function (response) {
                                console.log(response)
                                console.log("Doctor details updated successfully.");
                                // Optionally, you can redirect to another page or show a success message.
                            },
                            error: function (error) {
                                console.log("Error updating doctor details: " + error);
                                // Handle the error, show an error message, etc.
                            }
                        });
                    }
                });

            } else {
                console.log("Invalid doctorId provided in the URL.");
            }
        });
    </script>
</body>

</html>